(function(){var a="1.5.2";this.BIT=this.BIT||{};var b=this.BIT,c=Array.prototype.slice,d=function(a,c,d){if(null!=a)if(Array.prototype.forEach&&a.forEach===Array.prototype.forEach)a.forEach(c,d);else if(b.Utils.Object.isArray(a))for(var e=0,f=a.length;f>e;e++)c.call(d,a[e],e,a);else for(var g in a)a.hasOwnProperty(g)&&c.call(d,a[g],g,a)},e=function(a,b,c){for(var d in b)("undefined"==typeof a[d]||c)&&(a[d]=b[d]);return a},f=function(a){for(var c=b,d=a?a.split("."):[],e=0,f=d.length;f>e;e++){var g=d[e],h=c[g];h||(h={},c[g]=h),c=h}return c},g=function(a,c){var d="string"==typeof a?b.createObj(a):a;return e(d,c)};b.copy=e,b.createObj=f,b.extend=g;var h="https:"==document.location.protocol?"https:":"http:";e(b,{baseUrl:h+"//www.bandsintown.com",apiBaseUrl:h+"//api.bandsintown.com",assetHost:h+"//d38hmgjgf0kofx.cloudfront.net",widgets:[],widgetDialogEnabled:!0,iOSBannerEnabled:!1,cameFromCodes:{fbShare:36,noTourDatesNotifyMe:38,rsvp:39,eventDetails:46,buyTickets:166,trackArtistHeader:176,customTickets:219,google:209}}),e(b,{findWidget:function(a){a=a.toString().replace(/[^\d]+/,"");for(var b=0,c=this.widgets.length;c>b;b++)if(this.widgets[b].timestamp==a)return this.widgets[b]},setup:function(a){this.setupIOSBanner(a.src)},setupIOSBanner:function(a){var c=/ios_banner_disabled=true/.test(a);if(!c&&b.iOSBannerEnabled&&!b.iOSBannerRendered&&b.Utils.Browser.iOS){var d=i.make("meta",{name:"apple-itunes-app",content:"app-id=471394851,affiliate-data=partnerId=30&siteID=9HbhZwoYOY0&u1=BITWidget"});i.append(document.head,d)}}}),b.extend("Utils.Array",{include:function(a,b){if(a.indexOf)return a.indexOf(b)>-1;for(var c=!1,d=0,e=a.length;e>d;d++)if(c=a[d]===b)return c;return c},make:function(a){var b;try{b=c.call(a)}catch(d){b=[];for(var e=0,f=a.length;f>e;e++)b.push(a[e])}return b}}),b.extend("Utils.Browser",function(){var a={},b=navigator.userAgent,c=/MSIE ([0-9]{1,}[\.0-9]{0,})/i;if(c.test(b)){a.IE=!0;var d=parseFloat(b.match(c)[1]);a.IE6=7>d,a.IE7=!a.IE6&&8>d}else a.IE=a.IE6=a.IE7=!1;return a.Opera=!a.IE&&"undefined"!=typeof window.opera,a.Mobile=/Android|webOS|iPhone|iPad|iPod|BlackBerry|Windows Phone|Kindle|Silk/i.test(b),a.iOS=/iPhone|iPad|iPod/i.test(b),a.Android=/Android/i.test(b),a}()),b.extend("Utils.Class",{inherit:function(a,c,d){var f=function(){a.apply(this,arguments)};b.extend(f,a);var g=function(){};return g.prototype=a.prototype,f.prototype=new g,c&&e(f.prototype,c,!0),d&&e(f,d,!0),f.prototype.constructor=f,f},extend:function(a,c){var d=b.Utils.Class.inherit(this,a,c);return d.extend=this.extend,d}}),b.extend("Utils.Color",{RGB_REGEX:/\(\s*(\d+)\W+(\d+)\W+(\d+)\s*\)/,HEX_REGEX:/[A-F0-9]+/i,rgbFromHexString:function(a){var b=a.match(this.HEX_REGEX)[0];return 6==b.length?[parseInt(b.substr(0,2),16)/255,parseInt(b.substr(2,2),16)/255,parseInt(b.substr(4,2),16)/255]:[parseInt(b[0]+b[0],16)/255,parseInt(b[1]+b[1],16)/255,parseInt(b[2]+b[2],16)/255]},rgbFromRgbString:function(a){var b=a.match(/\((\d+)\W+(\d+)\W+(\d+)\)/);return[b[1]/255,b[2]/255,b[3]/255]},parseRgb:function(a){var b=[0,0,0];return a.match(this.RGB_REGEX)?b=this.rgbFromRgbString(a):a.match(this.HEX_REGEX)&&(b=this.rgbFromHexString(a)),{red:b[0],green:b[1],blue:b[2]}},whiteOrBlack:function(a){var b=this.parseRgb(a),c=.213*b.red+.715*b.green+.072*b.blue;return.5>c?"white":"black"}}),b.extend("Utils.Document",{contentLoaded:function(a,b){var c=!1,d=!0,e=a.document,f=e.documentElement,g=e.addEventListener?"addEventListener":"attachEvent",h=e.addEventListener?"removeEventListener":"detachEvent",i=e.addEventListener?"":"on",j=function(d){("readystatechange"!=d.type||"complete"==e.readyState)&&(("load"==d.type?a:e)[h](i+d.type,j,!1),!c&&(c=!0)&&b.call(a,d.type||d))},k=function(){try{f.doScroll("left")}catch(a){return void setTimeout(k,50)}j("poll")};if("complete"==e.readyState)b.call(a,"lazy");else{if(e.createEventObject&&f.doScroll){try{d=!a.frameElement}catch(l){}d&&k()}e[g](i+"DOMContentLoaded",j,!1),e[g](i+"readystatechange",j,!1),a[g](i+"load",j,!1)}}}),b.extend("Utils.Element",{make:function(a,b,c){var d=this.attrs(document.createElement(a),b);return c&&this.html(d,c),d},empty:function(a){for(;a.firstChild;)a.removeChild(a.firstChild);return a},html:function(a,b){if("string"==typeof b)try{a.innerHTML=b}catch(c){this.empty(a),this.append(a,b)}else this.empty(a),this.append(a,b);return a},prepare:function(a,c,e){b.Utils.Object.isArray(a)||(a=[a]),e&&e.reverse&&(a=a.reverse()),d(a,function(a){if("string"==typeof a){var b=document.createElement("div");b.innerHTML=a,a=b.lastChild}c(a)})},append:function(a,b){return this.prepare(b,function(b){a.appendChild(b)}),a},prepend:function(a,b){return this.prepare(b,function(b){a.insertBefore(b,a.firstChild)},{reverse:!0}),a},before:function(a,b){return this.prepare(b,function(b){a.parentNode.insertBefore(b,a)}),a},after:function(a,b){return this.prepare(b,function(b){a.parentNode.insertBefore(b,a.nextSibling)},{reverse:!0}),a},remove:function(a){a.parentNode.removeChild(a)},css:function(a,b){return d(b,function(b,c){a.style[c]=b}),a},attrs:function(a,b){return arguments.length>1?this.setAttrs(a,b):this.getAttrs(a)},setAttrs:function(a,b){return d(b,function(b,c){a.setAttribute(c,b)}),a},getAttrs:function(a){var c={};return d(b.Utils.Array.make(a.attributes),function(a){c[a.name]=a.value}),c},getComputedStyle:function(a,b){if(a){var c;if(c="undefined"!=typeof a.currentStyle&&"undefined"==typeof window.opera?a.currentStyle:document.defaultView.getComputedStyle(a,null),!b)return c;var d=c[b];return"height"==b&&"auto"==d&&(d=a.offsetHeight),d}},closest:function(a,b){for(var c=null,d=a;null===c&&"body"!==d.tagName.toLowerCase();)d&&this.matchesSelector(d,b)&&(c=d),d=d.parentNode;return c},search:function(a,c){var e=b.Utils.Array.make;if(/^#/.test(a))return document.getElementById(a.replace("#",""));var f=c?c:document;if(f.querySelectorAll)return e(f.querySelectorAll(a));if(/^\w+$/.test(a))return e(f.getElementsByTagName(a));var g=a.split("."),h=new RegExp(g[1]),i=""==g[0]?"*":g[0];return tags=f.getElementsByTagName(i),matches=[],d(tags,function(a){a.className&&h.exec(a.className)&&matches.push(a)}),matches},matchesSelector:function(a,c){var d=a.webkitMatchesSelector||a.mozMatchesSelector||a.oMatchesSelector||a.matchesSelector;if(d)return d.call(a,c);var e=b.Utils.Element.search(c,a.parentNode);return b.Utils.Array.include(e,a)},getOuterHeight:function(a){var b=0,c=["borderTop","paddingTop","height","paddingBottom","borderBottom"];return d(c,function(c){var d=parseFloat(i.getComputedStyle(a,c));isNaN(d)&&(d=0),b+=d}),b},copyCss:function(a){var c,e=a.source,f=a.target,g=b.Utils.Element.getComputedStyle(e);try{c=g.hasOwnProperty("cssText")}catch(h){c=!1}if(c)f.style.cssText=g.cssText;else{var i=["fontFamily","fontSize","fontWeight","fontStyle","color","textTransform","textDecoration","letterSpacing","wordSpacing","lineHeight","textAlign","verticalAlign","direction","backgroundColor","backgroundImage","backgroundRepeat","backgroundPosition","backgroundAttachment","opacity","width","height","top","right","bottom","left","marginTop","marginRight","marginBottom","marginLeft","paddingTop","paddingRight","paddingBottom","paddingLeft","borderTopWidth","borderRightWidth","borderBottomWidth","borderLeftWidth","borderTopColor","borderRightColor","borderBottomColor","borderLeftColor","borderTopStyle","borderRightStyle","borderBottomStyle","borderLeftStyle","position","display","visibility","zIndex","overflowX","overflowY","whiteSpace","clip","float","clear","cursor","listStyleImage","listStylePosition","listStyleType","markerOffset"];d(i,function(a){var b=g[a];void 0!==b&&(f.style[a]=b)})}},fadeIn:function(a,b){b=b||{},this.css(a,{display:b.display||"block",opacity:0});var c=0,d=setInterval(function(){c+=.2,a.style.opacity=c.toFixed(1),1===parseInt(c)&&clearInterval(d)},100)},position:function(a){var c={},d=a.getBoundingClientRect(),e=parseFloat(b.Utils.Element.getComputedStyle(a,"marginTop"))||0,f=parseFloat(b.Utils.Element.getComputedStyle(a,"marginLeft"))||0;return c.top=d.top-e,c.bottom=d.bottom,c.verticalCenter=(c.top+c.bottom)/2,c.left=d.left-f,c.right=d.right,c.horizontalCenter=(c.left+c.right)/2,c}});var i=b.Utils.Element;b.extend("Utils.Event",{observe:function(a,b,c,e){"string"==typeof b&&(b=i.search(b)),("undefined"==typeof b.length||b===window)&&(b=[b]),"undefined"==typeof e&&(e=!1);var f=window.attachEvent?"attachEvent":"addEventListener";"attachEvent"===f&&(a="on"+a);var g=function(a){"undefined"==typeof a.target&&a.srcElement&&(a.target=a.srcElement),c.apply(this,arguments)};d(b,function(b){b[f](a,g,e)})},delegate:function(a,c,d,e){b.Utils.Event.observe(a,c,function(a){i.closest(a.target,d)&&e(a)})},prevent_default:function(a){a.preventDefault?a.preventDefault():a.returnValue=!1}}),b.extend("Utils.Function",{bind:function(a,b){var d,e,f=Function.prototype.bind,g=function(){};return a.bind===f&&f?f.apply(a,c.call(arguments,1)):(e=c.call(arguments,2),d=function(){if(!(this instanceof d))return a.apply(b,e.concat(c.call(arguments)));g.prototype=a.prototype;var f=new g,h=a.apply(f,e.concat(c.call(arguments)));return Object(h)===h?h:f})}}),b.extend("Utils.JSONLDEventConverter",{convertEvents:function(a){for(var b=[],c=0,d=a.length;d>c;c++)b.push(this.convertEvent(a[c]));return b},convertEvent:function(a){var c={"@context":"http://schema.org","@type":"MusicEvent",name:b.Utils.Text.stripHTMLText(a.title),image:a.artists[0].image_url,startDate:a.datetime,url:this.generateEventUrl(a),location:this.convertLocation(a.venue),performer:this.convertArtists(a.artists)};return"available"==a.ticket_status&&(c.offers=this.buildOffers(a)),c},buildOffers:function(a){return[{"@type":"Offer",url:this.buildTicketUrl(a,"google"),sameAs:this.buildTicketUrl(a,"robots"),availability:this.convertStatus(a.ticket_status),category:"primary"}]},convertStatus:function(a){var b={available:"InStock",unavailable:"SoldOut"};return b[a]},convertLocation:function(a){var c="United States"==a.country,d={"@type":"Place",name:b.Utils.Text.stripHTMLText(a.name),address:{"@type":"PostalAddress",addressCountry:a.country,addressLocality:a.city,addressRegion:c?a.region:""},geo:{"@type":"GeoCoordinates",latitude:a.latitude,longitude:a.longitude}};return d},convertArtist:function(a){var c=[window.location.origin];return a.facebook_page_url&&c.push(a.facebook_page_url),c.push([b.baseUrl,a.url].join("/")),{"@type":"MusicGroup",name:a.name,sameAs:c}},convertArtists:function(a){artistsLD=[];for(var b=0,c=a.length;c>b;b++){var d=this.convertArtist(a[b]);artistsLD.push(d)}return artistsLD},buildTicketUrl:function(a,c){var d={affil_code:c,came_from:b.cameFromCodes.google};return a.ticket_url.match(/artist=/)||(d.artist=this.artist.name),b.Utils.URI.build(a.ticket_url,d)},generateEventUrl:function(a){var c=encodeURIComponent(a.artists[0].name);return[b.baseUrl,"event",a.id].join("/")+"?"+["artist="+c,"came_from=209","affil_code=google"].join("&")}}),b.extend("Utils.JSONP",{getJSON:function(a){var b=this.buildCallbackName(),c=a.callback||function(){},d=a.callback_obj;window[b]=function(a){c.call(d,a);try{delete window[b]}catch(e){}};var e=a.url,f=/\?/.test(e)?"&":"?";e+=f+"callback="+b;var g=document.createElement("script");g.type="text/javascript",g.src=e,g.async=!0;var h=document.getElementsByTagName("head")[0]||document.documentElement;h.insertBefore(g,h.firstChild)},buildCallbackName:function(){var a;do a="bit_jsonp"+(new Date).getTime();while("undefined"!=typeof window[a]);return a}}),b.Utils.Log=function(a){if("undefined"==typeof b.Utils.Log.enabled&&(b.Utils.Log.enabled=!1),b.Utils.Log.enabled)try{var d=c.call(arguments);if(d.length>1){var e=d.slice(1,d.length);console.log(a,e)}else console.log(a)}catch(f){}},b.extend("Utils.Object",{isArray:function(a){return"[object Array]"==Object.prototype.toString.call(a)},isEmpty:function(a){if(this.isArray(a))return 0===a.length;for(var b in a)if(a.hasOwnProperty(b))return!1;return!0},keys:function(a){if(Object.keys)return Object.keys(a);var b=[];for(var c in a)a.hasOwnProperty(c)&&b.push(c);return b}}),b.extend("Utils.Support",{_support:{},fixedPosition:function(){return"undefined"!=typeof this._support.fixedPosition?this._support.fixedPosition:(this._support.fixedPosition=function(){var a=document.body;if(document.createElement&&a&&a.appendChild&&a.removeChild){var c=document.createElement("div");if(!c.getBoundingClientRect)return null;c.innerHTML="x",c.style.cssText="position:fixed;top:100px;",a.appendChild(c);var d=a.style.height,e=a.scrollTop;a.style.height="3000px",a.scrollTop=500;var f=c.getBoundingClientRect().top;a.style.height=d;var g,h=100;if(b.Utils.Browser.IE7){var i=5;g=f>=h-i&&h+i>=f}else g=f===h;return a.removeChild(c),a.scrollTop=e,g}return null}(),this._support.fixedPosition)},postMessage:function(){return"undefined"!=typeof window.postMessage}}),b.extend("Utils.Text",{defaultTruncateOptions:{length:100,omission:"...",maxLines:3},lastWordWithPrecedingWhitespaceRegexp:/\s*\S+$/,precedingAndTrailingWhitespaceRegexp:/^\s*|\s*$/g,truncate:function(a,c){c=c||{};var d=c.length||b.Utils.Text.defaultTruncateOptions.length,e="string"==typeof c.omission?c.omission:b.Utils.Text.defaultTruncateOptions.omission,f=c.maxLines||b.Utils.Text.defaultTruncateOptions.maxLines,g=new RegExp("(?:.*?\\n){"+f+"}"),h=b.Utils.Text.strip(a);if(h.length<=d&&!h.match(g))return h;for(h.match(g)&&(h=b.Utils.Text.strip(h.match(g)[0]));h.length>d;)h=h.replace(b.Utils.Text.lastWordWithPrecedingWhitespaceRegexp,"");return h+e},strip:function(a){return a.replace(b.Utils.Text.precedingAndTrailingWhitespaceRegexp,"").replace(/\r\n/g,"\n")},htmlEscapeLookup:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"},htmlEscapeRegexp:/[&<>"']/g,escapeHtml:function(a){return a?(""+a).replace(this.htmlEscapeRegexp,function(a){return b.Utils.Text.htmlEscapeLookup[a]}):""},autoLink:function(a,b){b=b||{};var c=a.replace(/(https?:\/\/[^\s]+)/g,'<a href="$1">$1</a>');return b.emailAddresses&&(c=c.replace(/(\w+@\w+\.\w+)/,'<a href="mailto:$1">$1</a>')),c},stripHTMLText:function(a){var c=document.createElement("div");return c.innerHTML=a,b.Utils.Text.strip(c.firstChild.textContent)||b.Utils.Text.strip(c.firstChild.innerText)||""}}),b.extend("Utils.URI",{parse:function(a){var b=document.createElement("a");return b.href=a,b},build:function(a,c){var e=b.Utils.Object.keys(c).sort();return d(e,function(e){var f=c[e],g=a.match(/\?/)?"&":"?";b.Utils.Object.isArray(f)?d(f,function(b){a+=g+e+"[]="+encodeURIComponent(b)}):a+=g+e+"="+encodeURIComponent(f)}),a}}),b.extend("Utils.Widget",{renderAll:function(){var a=function(a){new b.Widget(b.Utils.Widget.extractOptions(a)).insert_events(),i.remove(a)};d(i.search("a.bit-widget-initializer"),a),d(i.search("a.bit-widget-placeholder"),a)},optionToDataAttribute:function(a){return"data-"+a.replace(/_/g,"-")},extractOptions:function(a){var c=["artist","text_color","link_color","bg_color","separator_color","width","display_limit","notify_me","share_links","share_url","myspace_layout","div_id","facebook_page_id","event_data_links","track_artist_header","email_signup","open_fb_event_after_rsvp","prefix","affil_code","app_id","force_narrow_layout","ios_banner_enabled"],e=i.attrs(a),f={},g=["true","false"],h=/^\d+$/;return d(c,function(a){var c=this.optionToDataAttribute(a);if(e.hasOwnProperty(c)){var d=e[c];"artist"===a?d=String(d):b.Utils.Array.include(g,d)?d="true"===d:h.test(d)&&(d=parseInt(d)),f[a]=d}},this),f.div_id||(f.div_id="bit-widget-"+b.widgets.length,this.createInlineWidgetDiv(a,f.div_id)),f},createInlineWidgetDiv:function(a,b){i.after(a,i.make("div",{id:b}))}}),b.extend("Utils.Window",{isIframe:function(){return self!==top},dimensions:function(){return{width:this.width(),height:this.height()}},width:function(){return"CSS1Compat"===document.compatMode&&document.documentElement.clientWidth?document.documentElement.clientWidth:document.body.clientWidth},height:function(){return"CSS1Compat"===document.compatMode&&document.documentElement.clientHeight?document.documentElement.clientHeight:document.body.clientHeight},getScrollTop:function(){return window.pageYOffset?window.pageYOffset:(document.documentElement||document.body).scrollTop}}),b.extend("Utils.XD",{send:function(a,c){b.Utils.XD.PostMessage.send(a,c)},listen:function(a,c){b.Utils.XD.PostMessage.listen(a,c)},confirmMessageReceivedFromParent:function(a){var c=b.Utils.XD;b.Utils.Log("[child ("+a+")] waiting for postMessage from parent"),c.listen(function(d){"postmessage-init"!==d.action||c.hasReceivedMessageFromParent||(b.Utils.Log("[child ("+a+")] received postMessage from parent"),c.hasReceivedMessageFromParent=!0,c.send({action:"postmessage-confirmed",windowName:a},{targetOrigin:b.Utils.XD.parent_window_location}))})},confirmedChildWindows:[],initializeCommunicationWithChild:function(a,c){var d=b.Utils.XD,e=b.Utils.Array.include;d.listen(function(a){"postmessage-confirmed"!==a.action||e(d.confirmedChildWindows,a.windowName)||(b.Utils.Log("[parent] confirmed postMessage with child ("+a.windowName+")"),d.confirmedChildWindows.push(a.windowName),c())}),b.Utils.Log("[parent] initializing postMessage with child ("+a+")"),d.send({action:"postmessage-init"},{targetWindowName:a})},PostMessage:{send:function(a,c){c=c||{};var d=b.Utils.XD.PostMessage.getTargetWindow(c.targetWindowName,window),e=c.targetOrigin||"*";a=b.Utils.XD.encodeMessage(a),b.Utils.Log("Sending postMessage... targetWindow / message / options",d,a,c),d.postMessage(a,e)},getTargetWindow:function(a,b){if(!a)return b.parent;for(var c,d=i.search("iframe"),e=0,f=d.length;f>e;e++)if(d[e].name===a){c=b.frames[e];break}return c},listen:function(a,b){b=b||{},this.mainListener||this.setupMainListener(),this.listeners.push({callback:a,options:b})},listeners:[],setupMainListener:function(){var a=this.listeners;b.Utils.Event.observe("message",window,function(c){var e=!1;d(a,function(a){var d=a.callback,f=a.options||{},g="undefined"==typeof f.origin||c.origin==f.origin;if(g&&b.Utils.XD.BIT_MESSAGE_REGEX.test(c.data)){e||(b.Utils.Log("Received BIT postMessage",c),e=!0);var h=b.Utils.XD.decodeMessage(c.data);d(h)}})}),this.mainListener=!0},sendInitialMessage:function(){b.Utils.XD.send({action:"init-postmessage"},{targetOrigin:b.Utils.XD.parent_window_location})}},decodeMessage:function(a){a=a.replace(/^#/,"");var b={},c=a.split("&");return d(c,function(a){var c=a.split("=");b[c[0]]=decodeURIComponent(c[1])}),b},encodeMessage:function(a,c){if("object"==typeof a){var e=[];d(a,function(a,b){var c=b+"="+encodeURIComponent(a);e.push(c)}),a=e.join("&")}return b.Utils.XD.BIT_MESSAGE_REGEX.test(a)||(a+="&BIT=true"),c&&d(c,function(b,c){a+="&"+c+"="+encodeURIComponent(b)}),a},BIT_MESSAGE_REGEX:/BIT=true/}),b.View=function(a){e(this,a||{}),this.ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},e(b.View,{delegateEventRegex:/^(\w+)\s*(.*)/,extend:b.Utils.Class.extend},!0),e(b.View.prototype,b.Utils.Element,!0),e(b.View.prototype,{tagName:"div",$:function(a,b){return this.search(a,b||this.el)},initialize:function(){},render:function(){return this},ensureElement:function(){if(!this.el){var a=this;attrs={},getValue=function(b){return"function"==typeof a[b]?a[b]():a[b]},this.attributes&&(attrs=getValue("attributes")),this.id&&(attrs.id=getValue("id")),this.className&&(attrs["class"]=getValue("className")),this.el=this.make(this.tagName,attrs)}},delegateEvents:function(){this.events;d(this.events,function(a,c){var d=b.Utils.Function.bind(this[a],this),e=c.match(b.View.delegateEventRegex),f=e[1],g=e[2],h=""!==g?this.el:this.el.parentNode||document.body;b.Utils.Event.delegate(f,h,g||"*",d)},this)}},!0),b.extend("Views",{WidgetDialog:b.View.extend({id:"bit-widget-dialog",iframe_height:"275px",iframe_width:"500px",initialize:function(){this.loadedIframes={}},show:function(){this.css(this.container,{display:"block"}),this.showContent()},hide:function(){this.hideIframes(),this.showLoader(),this.css(this.container,{display:"none"})},insertContent:function(){this.contentAdded||(document.body.appendChild(this.el),this.html(this.el,b.Views.WidgetDialog.dialogHTML),this.contentAdded=!0)},hideIframes:function(){var a=this.$("iframe"),b=this;d(a,function(a){a.onload=a.onreadystatechange=function(){b.loadedIframes[a.getAttribute("id")]=!0},a.style.display="none"})},showLoader:function(){this.dialog_loading.style.display=""},hideLoader:function(){this.dialog_loading.style.display="none"},showIframeAndEvent:function(a){var c=a.iframe,d=this,e=function(){d.loadedIframes[c.getAttribute("id")]=!0,d.showIframe(c.id),b.Utils.XD.send({event_id:a.event_id,action:a.action,open_fb_event_after_rsvp:a.widget.open_fb_event_after_rsvp},{targetWindowName:c.name})};this.show(),this.loadedIframes[c.getAttribute("id")]?e():c.onload=c.onreadystatechange=e},findIframeForWidget:function(a){for(var b=this.$("iframe"),c=0,d=b.length;d>c;c++)if(b[c].getAttribute("id").match(a))return b[c]},triggerEmailSignup:function(a){var c=a.iframe,d=this,e=function(){d.loadedIframes[c.getAttribute("id")]=!0,b.Utils.XD.send({event_id:a.event_id,action:"show_email_signup"},{targetWindowName:c.name})};this.loadedIframes[c.getAttribute("id")]?e():c.onload=c.onreadystatechange=e},showContent:function(){this.content.style.display="block",this.center()},areMinDimensionsAvailable:function(){var a=b.Utils.Window.dimensions();return a.width>=505&&a.height>=400},center:function(){if("none"!=this.container.style.display){var a=b.Utils.Window.isIframe()?"centerForIframe":"centerForWindow";this[a]()}},centerForWindow:function(){var a=b.Utils.Element.getOuterHeight(this.y_offset),c="undefined"==typeof window.innerHeight?document.documentElement.clientHeight:window.innerHeight,d=c/2-a/2;b.Utils.Support.fixedPosition()||(d+=b.Utils.Window.getScrollTop()),this.y_offset.style.top=parseInt(d)+"px"},centerForIframe:function(){this.container.style.position="absolute";{var a=this.getOuterHeight(this.y_offset),c=b.Utils.Window.getScrollTop(),d=this.position(this.closest(this.clicked_link,"div")),e=this.position(this.clicked_link),f=parseInt(c+e.verticalCenter-a/2);parseInt(d.bottom+c-a)}f=Math.min(f,newTopMin),f=Math.max(3,f),this.y_offset.style.top=f+"px"},showIframe:function(a){this.hideLoader(),this.hideIframes(),this.css(this.$("#"+a),{display:"block"}),this.show()},events:{"click #bit-widget-dialog-close":"hide"},handleXDMessage:function(a){if("update_iframe_height"===a.action){var c=Math.min(b.Utils.Window.dimensions().height-100,parseInt(a.height));document.getElementById(a.iframe_id).style.height=c+"px",this.center()}else"close_dialog"===a.action?this.hide():"show_iframe"===a.action?this.showIframe(a.iframe_id):"show_track_artist_header"===a.action&&this.showTrackArtistHeader(a)},showTrackArtistHeader:function(a){var c=b.findWidget(a.iframe_id);c&&c.showTrackArtistHeader()},render:function(){if(this.rendered=!0,this.insertContent(),this.clicked_link=null,this.container=this.$("#bit-widget-dialog-container"),this.border=this.$("#bit-widget-dialog-border"),this.y_offset=this.$("#bit-widget-dialog-y-offset"),this.content=this.$("#bit-widget-dialog-content"),this.dialog_loading=this.$("#bit-widget-dialog-loading"),this.close_button=this.$("#bit-widget-dialog-close"),!b.Utils.Window.isIframe()){var a=document.onresize?document:window;b.Utils.Event.observe("resize",a,b.Utils.Function.bind(this.center,this))}return b.Utils.XD.listen(b.Utils.Function.bind(this.handleXDMessage,this)),this.border.style.display="block",this}},{dialogHTML:['<div class="generic_dialog pop_dialog" style="display:none" id="bit-widget-dialog-container">','<div class="generic_dialog_popup wide-popup">','<div class="pop_container_advanced popup-border-outer" id="bit-widget-dialog-y-offset">','<div class="pop_container_advanced popup-border-inner" id="bit-widget-dialog-border"></div>','<div class="pop_content popup-content" id="bit-widget-dialog-content">','<div id="bit-widget-dialog-loading">','<h2 class="dialog_title"><span>Loading...</span></h2>','<div class="dialog_content">','<div class="dialog_body">','<div class="loading"></div>',"</div>",'<div class="dialog_buttons clearfix">','<label class="uiButton uiButtonLarge uiButtonDefault">','<input type="button" value="Close" id="bit-widget-dialog-close" />',"</label>","</div>","</div>","</div>","</div>","</div>","</div>","</div>"].join(""),dialogCSS:["#bit-widget-dialog-container { position: fixed; width: 100%; height: 100%; margin: auto; }","#bit-widget-dialog { color: #333333; direction: ltr; font-family: 'lucida grande',tahoma,verdana,arial,sans-serif; font-size: 11px; text-align: left; }","#bit-widget-dialog label { color: #666666; cursor: pointer; font-weight: bold; vertical-align: middle; }","body#bit-widget-dialog { margin: 0px; padding: 0px; }","#bit-widget-dialog-loading .loading { height: 32px; width: 100%; background: transparent url('",b.assetHost,"/images/facebook/ajax-loader-large.gif') no-repeat scroll center center; }","#bit-widget-dialog .pop_content{direction:ltr}","#bit-widget-dialog {height:0;left:0;overflow:visible;outline:none;position:absolute;top:0;width:100%;z-index:250}","#bit-widget-dialog .generic_dialog_popup{height:0;overflow:visible;position:relative;width:520px;margin:auto}","#bit-widget-dialog .pop_content h2.dialog_title{background:#6d84b4;border:1px solid #3b5998;border-bottom:none;color:#fff;font-size: 14px;font-weight:bold;margin:0;}","#bit-widget-dialog .pop_content h2 span{display:block;padding:5px 10px}","#bit-widget-dialog .pop_content .dialog_content{background:#fff;border:1px solid #555;border-top-width:0}","#bit-widget-dialog .pop_content .dialog_body{padding:10px;border-bottom:1px solid #ccc}","#bit-widget-dialog .pop_content .dialog_buttons{background:#f2f2f2;padding:8px 10px 8px 10px;position:relative;text-align:right}","#bit-widget-dialog .pop_container_advanced{border-radius:8px;-webkit-border-radius:8px;-moz-border-radius:8px;padding:10px}","#bit-widget-dialog .uiButton,#bit-widget-dialog .uiButtonSuppressed:active,#bit-widget-dialog .uiButtonSuppressed:focus,#bit-widget-dialog .uiButtonSuppressed:hover{background:#eee url('",b.assetHost,"/images/facebook/silver-blue-bg.png') repeat 0 0;border:1px solid #999;border-bottom-color:#888;box-shadow:0 1px 0 rgba(0, 0, 0, .1);-moz-box-shadow:0 1px 0 rgba(0, 0, 0, .1);cursor:pointer;display:-moz-inline-box;display:inline-block;font-size:11px;font-weight:bold;line-height:normal !important;padding:2px 6px;text-align:center;text-decoration:none;vertical-align:top;white-space:nowrap}","#bit-widget-dialog .uiButtonConfirm{background-color:#5b74a8;background-position:0 -48px;border-color:#29447e #29447e #1a356e}","#bit-widget-dialog .uiButton:active,#bit-widget-dialog .uiButtonDepressed{background:#ddd;border-bottom-color:#999;box-shadow:0 1px 0 rgba(0, 0, 0, .05);-moz-box-shadow:0 1px 0 rgba(0, 0, 0, .05)}","#bit-widget-dialog .uiButton .uiButtonText,#bit-widget-dialog .uiButton input{background:none;border:0;color:#333;cursor:pointer;display:-moz-inline-box;display:inline-block;font-family:'Lucida Grande', Tahoma, Verdana, Arial, sans-serif;font-size:11px;font-weight:bold;margin:0;outline:none;padding:1px 0 2px;white-space:nowrap}","#bit-widget-dialog .uiButtonLarge,#bit-widget-dialog .uiButtonLarge .uiButtonText,#bit-widget-dialog .uiButtonLarge input{font-size:13px}","#bit-widget-dialog .uiButtonSpecial .uiButtonText,#bit-widget-dialog .uiButtonSpecial input,#bit-widget-dialog .uiButtonSpecial.uiButtonDisabled .uiButtonText,#bit-widget-dialog .uiButtonSpecial.uiButtonDisabled input,#bit-widget-dialog .uiButtonConfirm .uiButtonText, #bit-widget-dialog .uiButtonConfirm input, #bit-widget-dialog .uiButtonConfirm.uiButtonDisabled .uiButtonText, #bit-widget-dialog .uiButtonConfirm.uiButtonDisabled input { color: #FFFFFF; }","#bit-widget-dialog .uiButtonConfirm:active{background:#4f6aa3;border-bottom-color:#29447e}","#bit-widget-dialog .popup-border-outer { z-index: 1; background: none; position: relative; }","#bit-widget-dialog .popup-border-inner { background-color: #525252; -moz-opacity: 0.7; opacity: 0.7; position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 1; padding: 0; filter: progid:DXImageTransform.Microsoft.Alpha(Opacity=70); }","#bit-widget-dialog .popup-content { position: relative; z-index: 2; }","#bit-widget-dialog h2 { padding: 0px; }","#bit-widget-dialog .clear { clear: both; }","* html #bit-widget-dialog .popup-border-inner  { display: none; }","* html #rsvp-dialog-container { position: absolute; }"].join("")})}),b.Widget=function(a){this.artist=a.artist,this.text_color=a.text_color,this.link_color=a.link_color,this.bg_color=a.bg_color,this.separator_color=a.separator_color||"#E9E9E9",this.width=a.width||"100%",this.display_limit=a.display_limit||Number.MAX_VALUE,this.notify_me=0!=a.notify_me,this.share_links=0!=a.share_links,this.share_url=a.share_url||window.location.href,this.myspace_layout=a.myspace_layout||!1,this.div_id=a.div_id,this.facebook_page_id=String(a.facebook_page_id||""),this.event_data_links=0!=a.event_data_links,this.track_artist_header=0!=a.track_artist_header,this.email_signup=0!=a.email_signup,this.open_fb_event_after_rsvp=a.open_fb_event_after_rsvp||!1,this.prefix=a.prefix||"js",this.affil_code=this.prefix+"_"+(a.affil_code||window.location.host),this.app_id=this.prefix+"_"+(a.app_id||window.location.host),this.timestamp=(new Date).getTime(),this.force_narrow_layout=a.force_narrow_layout||!1,this.local_events_loaded=!1,this.artist_events_loaded=!1,this.pending_writes=[],this.write_pending=!1,this.layout=this.use_narrow_layout()?"narrow":"standard",this.source=a.source,b.WidgetDialog=b.WidgetDialog||new b.Views.WidgetDialog,this.dialog=b.WidgetDialog,b.widgets.push(this)},e(b.Widget.prototype,{insert_events:function(){return this.artist?(this.write(this.loading_image()),b.Utils.JSONP.getJSON({url:this.localEventsUrl(),callback:this.local_events_callback,callback_obj:this}),b.Utils.JSONP.getJSON({url:this.artistEventsUrl(),callback:this.artist_events_callback,callback_obj:this})):this.write(this.no_artist_given()),this},write:function(a,b){var c=this;"undefined"==typeof b&&(b=!1),this.div_id||(this.div_id=this.unique_id("widget-container"),document.write('<div id="'+this.div_id+'"></div>')),document.getElementById(this.div_id)&&!this.write_pending?document.getElementById(this.div_id).innerHTML=a:(b||this.pending_writes.push(a),this.write_pending||(this.write_pending=!0,setTimeout(function(){c.retry_write()},13)))},retry_write:function(){var a=this;document.getElementById(this.div_id)?(this.write_pending=!1,this.write(this.pending_writes[this.pending_writes.length-1],!0)):setTimeout(function(){a.retry_write()},13)},unique_id:function(a){return[a,this.timestamp].join("-")},render:function(){this.write(this.toHtml(this.artist_events,this.local_events)),this.invert_element_colors(),this.on("click","tr[data-bit-event-id] td",this.click_event_row_rsvp_button),this.on("click","a.bit-events-nav",this.toggle_events_table),this.on("click","a.bit-show-all-dates",this.show_all_events),this.rendered_callback()},click_event_row_rsvp_button:function(a){var b=i.closest(a.target,"a");if(!b){var c=i.closest(a.target,"tr[data-bit-event-id]");if(c){var d=i.search("a.bit-rsvp",c)[0];if(d)try{d.click()}catch(e){console&&console.error&&console.error(e)}}}},on:function(a,c,d){b.Utils.Event.observe(a,i.search(c,this.root_element()),b.Utils.Function.bind(d,this))},loading_image:function(){return['<div style="text-align:center;">','<img src="'+b.assetHost+"/images/widget-ajax-loader.gif\" style='width:43px;height:11px;' />","</div>"].join("")},root_element:function(){if(this._root_element)return this._root_element;for(var a=i.search("div"),b=0,c=a.length;c>b;b++){var d=a[b];if(d.getAttribute("data-bit-widget-id")==this.timestamp){this._root_element=d;break}}return this._root_element},invert_element_colors:function(){var a=i.search(".bit-invert",this.root_element());d(a,function(a){var c=i.getComputedStyle(a,"color");i.css(a,{color:b.Utils.Color.whiteOrBlack(c),backgroundColor:c})})},events_table_navigation:function(a){var b=[],c={upcoming:"Upcoming",local:"Local Dates"};
return d(c,function(c,d){b.push(d===a?c:"<a href='javascript:;' class='bit-events-nav' data-events-type='"+d+"'>"+c+"</a>")}),"<span class='bit-header-links'>"+b.join(" | ")+"</span>"},events_table:function(a){var b,c=a.events,e=a.type,f=a.layout,g="local"==e?"display:none;":"",h="standard"==f?"bit-events":"bit-events-narrow",i=[];b="narrow"===f?["<tr class='bit-header-narrow'>","<th colspan='5'>","<div class='bit-header-overflow-fix'>",this.events_table_navigation(e),this.artist_share_links(),"</div>","</th>","</tr>"].join(""):["<tr class='bit-header'>","<th class='bit-description-links'>&nbsp;</th>","<th colspan='7'>","<div class='bit-header-overflow-fix'>",this.events_table_navigation(e),this.artist_share_links(),"</div>","</th>","</tr>","<tr>","<th class='bit-description-links'>&nbsp;</th>","<th class='bit-date'>Date</th>","<th class='bit-venue'>Venue</th>","<th class='bit-location'>Location</th>","<th class='bit-artist-event-link'>&nbsp;</th>","<th class='bit-tickets' colspan='3'>Tickets</th>","</tr>"].join(""),c.length>0?d(c,function(b,c){var d={hidden:c>=this.display_limit,layout:a.layout};i.push("narrow"===a.layout?this.narrowEventRow(b,d):this.standardEventRow(b,d))},this):i.push(this.api_error_response()||this.no_dates_message(e));var j=this.display_limit<c.length?"<tr class='bit-bottom'><td colspan='7'><a href='javascript:;' class='bit-show-all-dates'>Show All Dates</a></td></tr>":"";return["<table cellpadding='0' cellspacing='0' class='"+h+"' style='"+g+"' data-events-type='"+e+"'>","<tbody>",b,i.join(""),j,"</tbody>","</table>"].join("")},toHtml:function(a,b){var c='<div style="display:none">&nbsp;</div>';return[c,this.css(),"<div id='bit-events' data-bit-widget-id='"+this.timestamp+"' data-bit-artist='"+this.artist_param()+"' class='bit-widget-container'>",this.track_artist_header?this.track_artist_header_content():"",this.events_table({events:a,type:"upcoming",layout:this.layout}),this.events_table({events:b,type:"local",layout:this.layout}),"</div>"].join("")},track_artist_header_content:function(){var a=this.api_artist||this.artist,c=this.track_artist_url(b.cameFromCodes.trackArtistHeader);return["<a href='",c,"' target='_blank' class='bit-track-artist-header' style='display:none;'>","<div class='bit-invert'>Track ",a,"</div>","<div class='bit-notify'><strong>Notify Me</strong> when ",a," comes to town.</div>","</a>"].join("")},showTrackArtistHeader:function(){var a=i.search("a.bit-track-artist-header",this.root_element())[0];a&&i.fadeIn(a,{display:"block"})},standardEventRow:function(a,c){return["<tr class='"+(c.hidden?"bit-hidden":"")+"' data-bit-event-id='"+a.id+"'>","<td class='bit-description-links'>&nbsp;</td>","<td class='bit-date'><span class=\"bit-event-data\">",this.formatted_date(a),"</span></td>","<td class='bit-venue'><span class=\"bit-event-data\">",b.Utils.Text.escapeHtml(a.venue.name),"</span>",this.lineup(a),"</td>","<td class='bit-location'><span class=\"bit-event-data\">",this.formatted_location(a),"</span></td>","<td class='bit-artist-event-link'>",this.artistEventLinkContent(a),"</td>","<td class='bit-tickets'>",this.ticket_link(a),"</td>",this.rsvp_td(a),"</tr>"].join("")},narrowEventRow:function(a,b){return["<tr class='"+(b.hidden?"bit-hidden":"")+"' data-bit-event-id='"+a.id+"'>","<td class='bit-description-links'>&nbsp;</td>","<td class='bit-date'><span class=\"bit-event-data\">",this.formatted_date(a),"</span></td>","<td class='bit-concert'>",this.narrow_layout_middle_column_html(a),"</td>",this.rsvp_td(a),"</tr>"].join("")},customTicketUrl:function(a){return b.Utils.URI.build(b.baseUrl+"/event/"+a.id+"/buy_tickets",{artist:this.artist,seller_type:"custom",came_from:b.cameFromCodes.customTickets,affil_code:this.affil_code})},artistEventLinkContent:function(a){var b=a.artist_event_link_label;return b?"<a href='"+this.customTicketUrl(a)+"' target='_blank' class='bit-artist-event-link'>"+b+"</a>":"&nbsp;"},narrow_layout_middle_column_html:function(a){var c=['<div class="venue"><span class="bit-event-data">',b.Utils.Text.escapeHtml(a.venue.name),"</span></div>",this.lineup(a),'<div class="location"><span class="bit-event-data">',this.formatted_location(a),"</span></div>"];return"available"===a.ticket_status&&c.push(this.ticket_link(a)),a.artist_event_link_label&&c.push(this.artistEventLinkContent(a)),c.join("")},rsvp_link:function(a){return"<a target='_blank' class='bit-rsvp' href='"+this.rsvp_url(a)+"'>RSVP</a>"},rsvp_url:function(a){var c=b.Utils.Browser.Mobile?a.facebook_rsvp_url.replace("/facebook_rsvp",""):a.facebook_rsvp_url;return c.replace(/came_from=\d+/,"came_from="+b.cameFromCodes.rsvp)},formatted_location:function(a){var b=a.venue,c="united states"===b.country.toLowerCase()?b.region:b.country;return b.city+", "+c},lineup:function(a){if(1===a.artists.length)return"";var c=[];return d(a.artists.splice(1,a.artists.length),function(a){c.push(a.name)}),['<div class="lineup">','<span class="bit-event-data">',b.Utils.Text.truncate("w/ "+c.join(", "),{length:25}),"</span>","</div>"].join("")},artist_param:function(){var a=this.api_artist||this.artist;return a=a.replace(/\?/g,encodeURIComponent("?")),a=a.replace(/\//g,encodeURIComponent("/")),a=encodeURIComponent(a),a=a.replace(/'/g,escape("'")),a=a.replace(/"/g,escape('"'))},facebookPageIdParam:function(){var a=/^\d+$/;return a.test(this.facebook_page_id)?"fbid_"+this.facebook_page_id:null},ticket_link:function(a){if("available"==a.ticket_status){var c={affil_code:this.affil_code,came_from:b.cameFromCodes.buyTickets};return a.ticket_url.match(/artist=/)||(c.artist=this.artist_param()),'<a target="_blank" class="bit-buy-tix" href="'+this.ticket_url(a)+'">'+a.ticket_type+"</a>"}return"&nbsp;"},ticket_url:function(a){return b.Utils.URI.build(b.baseUrl+"/event/"+a.id+"/buy_tickets",{artist:this.artist,app_id:this.app_id,came_from:b.cameFromCodes.buyTickets,affil_code:this.affil_code})},rsvp_td:function(a){return'<td class="bit-rsvp"><label class="bit-uiButton bit-uiButtonDefault">'+this.rsvp_link(a)+"</label></td>"},css:function(){var a="#bit-events[data-bit-widget-id='"+this.timestamp+"'] ",c="";b.Widget.staticCSSAdded||(c+=b.Widget.staticCSS,b.Widget.staticCSSAdded=!0),b.Views.WidgetDialog.css_added||(c+=b.Views.WidgetDialog.dialogCSS,b.Views.WidgetDialog.css_added=!0);var d=[a+"{ width:"+this.width+";}",a+(this.bg_color?"{ background-color: "+this.bg_color+";}":"{}"),a+".bit-events, .bit-events-narrow { width:"+this.width+";}",a+".bit-events td { border-top: 1px solid "+this.separator_color+";}",a+".bit-events-narrow td { border-top: 1px solid "+this.separator_color+";}",a+"td"+(this.text_color?"{ color: "+this.text_color+";}":"{}"),a+"th"+(this.text_color?"{ color: "+this.text_color+";}":"{}"),a+"td"+(this.bg_color?"{ background-color: "+this.bg_color+";}":"{}"),a+"th"+(this.bg_color?"{ background-color: "+this.bg_color+";}":"{}"),a+"a"+(this.link_color?"{ color: "+this.link_color+";}":"{}"),a+".bit-events tr.bit-dashed-border td { border-top: 1px dashed "+this.separator_color+";}",a+".bit-events-narrow tr.bit-dashed-border td.bit-description { border-top: 1px dashed "+this.separator_color+";}",a+".bit-events-narrow tr.no-dates td span"+(this.myspace_layout?"{ display: block; }":"{}"),a+"table { border-bottom: 1px solid "+this.separator_color+";}",a+"a.bit-track-artist-header {border-top: 1px solid "+this.separator_color+"; border-bottom: 1px solid "+this.separator_color+"; }"].join("");return'<style type="text/css">'+c+d+"</style>"},no_artist_given:function(){return[this.css(),"<div class='bit-no-upcoming-events'>No artist given.</div>"].join("")},no_dates_message:function(a){var c="No "+a+" dates.";return this.notify_me&&(c+=" <a href='"+this.track_artist_url(b.cameFromCodes.noTourDatesNotifyMe)+"'>Notify me when <span>"+(this.api_artist||this.artist)+"</span> comes to my area.</a>"),this.use_narrow_layout()?"<tr class='no-dates'><td colspan='4'>"+c+"</td></tr>":"<tr class='no-dates'><td class='bit-description-links'>&nbsp;</td><td colspan='6'>"+c+"</td></tr>"},api_error_response:function(){return this.api_error?this.use_narrow_layout()?"<tr class='no-dates'><td colspan='4'>"+b.Utils.Text.autoLink(this.api_error)+"</td></tr>":"<tr class='no-dates'><td class='bit-description-links'>&nbsp;</td><td colspan='6'>"+b.Utils.Text.autoLink(this.api_error,{emailAddresses:!0})+"</td></tr>":void 0},track_artist_url:function(a){return[b.baseUrl,"/track/",this.artist_param(),"?came_from=",a].join("")},artist_share_links:function(){return this.share_links?["<span class='bit-share-links'>","<a target='_blank' title='Share this on Facebook' class='bit-fb-share' href='"+this.fb_share_link()+"'></a>","<a target='_blank' title='Share this on Twitter' class='bit-twitter-share' href='"+this.twitter_share_link()+"'></a>","</span>","<span class='bit-share-text'>Share:</span>"].join(""):""},bit_share_link:function(a){return[b.baseUrl,"/",this.artist_param(),"/share?u=",encodeURIComponent(this.share_url),"&came_from=",a].join("")},fb_share_link:function(){var a=this.bit_share_link(b.cameFromCodes.fbShare),c="123966167614127",d=b.baseUrl+"/"+this.artist_param()+"/photo/medium.jpg",e=this.artist+" - Tour Dates",f=b.Utils.URI.parse(this.share_url).hostname,g="",h=b.baseUrl+"/redirect?u="+encodeURIComponent(this.share_url);if(/^http:\/\/myspace\.com\/\d+/.test(this.share_url)&&(e+=" on MySpace"),0==this.artist_events.length)var i="";else if(1==this.artist_events.length)var i="1 upcoming tour date";else var i=this.artist_events.length+" upcoming tour dates";return["http://www.facebook.com/dialog/feed?","app_id=",c,"&link=",encodeURIComponent(a),"&picture=",d,"&name=",encodeURIComponent(e).replace(/'/g,escape("'")),"&caption=",encodeURIComponent(f),"&description=",encodeURIComponent(i),"&properties=",encodeURIComponent(g),"&redirect_uri=",encodeURIComponent(h)].join("")},twitter_share_link:function(){return["http://www.bandsintown.com/",this.artist_param(),"/twitter_share?u=",encodeURIComponent(this.share_url)].join("")},use_narrow_layout:function(){return 1==this.force_narrow_layout?!0:this.width.match(/\d+px$/)?parseInt(this.width)<275:!1},find_artist_event:function(a){for(var b=null,c=0;c<this.artist_events.length;c++)if(this.artist_events[c].id==a){b=this.artist_events[c];break}return b},artistEventsUrl:function(){var c={api_version:"2.0",app_id:this.app_id,extended:!0,widget_version:a};return this.facebookPageIdParam()&&(c.artist_id=this.facebookPageIdParam()),b.Utils.URI.build(b.apiBaseUrl+"/artists/"+this.artist_param()+"/events.json",c)},localEventsUrl:function(){var c={api_version:"2.0",app_id:this.app_id,extended:!0,location:"use_geoip",widget_version:a};return this.facebookPageIdParam()&&(c.artist_id=this.facebookPageIdParam()),b.Utils.URI.build(b.apiBaseUrl+"/artists/"+this.artist_param()+"/events/search.json",c)},artist_events_callback:function(a){this.artist_events_loaded=!0,this.artist_events=a&&!a.errors?a:[],this.api_error=null;try{a.errors[0].match(/install/i)&&(this.api_error=a.errors[0])}catch(b){}this.artist_events.length>0&&(this.api_artist=this.artist_events[0].artists[0].name,this.render_json_ld()),this.local_events_loaded&&this.render()},render_json_ld:function(){var a=document.createElement("script");a.type="application/ld+json";var c=b.Utils.JSONLDEventConverter.convertEvents(this.artist_events);a.text=JSON.stringify(c),document.body.appendChild(a)},local_events_callback:function(a){this.local_events_loaded=!0,this.local_events=a&&!a.errors?a:[],this.api_error=null;try{a.errors[0].match(/install/i)&&(this.api_error=a.errors[0])}catch(b){}this.local_events.length>0&&(this.api_artist=this.local_events[0].artists[0].name),this.artist_events_loaded&&this.render()},widget_iframe_url:function(){return b.Utils.URI.build(b.baseUrl+"/"+this.artist_param()+"/widget_iframe",{iframe_id:this.unique_id("widget-iframe"),parent_window_location:window.location.href,track_artist_header:this.track_artist_header,affil_code:this.affil_code})},add_event_data_links:function(){var a=i.search("span.bit-event-data",this.root_element());d(a,function(a){var b=i.closest(a,"tr").getAttribute("data-bit-event-id"),c=i.make("a",{href:this.rsvp_url(this.find_artist_event(b)),"class":"bit-event-data",target:"_blank"},a.innerHTML);i.copyCss({target:c,source:a,except:["cursor"]}),i.css(c,{cursor:"pointer"}),i.before(a,c),i.remove(a)},this)},canRenderIframe:function(){return b.widgetDialogEnabled?b.Utils.Browser.Mobile?!1:b.Utils.Window.isIframe()&&!this.dialog.areMinDimensionsAvailable()?!1:!0:!1},rendered_callback:function(){if(0!==this.artist_events.length&&(this.event_data_links&&this.add_event_data_links(),b.Utils.Support.postMessage()&&(this.dialog.rendered||this.dialog.render(),this.canRenderIframe()))){var a=this.unique_id("widget-iframe"),c=i.make("iframe",{id:a,name:a,src:this.widget_iframe_url(),width:this.dialog.iframe_width,height:this.dialog.iframe_height,frameBorder:"0",scrolling:"auto"});c.onload=c.onreadystatechange=b.Utils.Function.bind(this.iframeLoaded,this),i.css(c,{display:"none"}),i.append(this.dialog.content,c),this.widget_iframe=c}},iframeLoaded:function(){var a=this.unique_id("widget-iframe");this.dialog.loadedIframes[a]=!0,b.Utils.XD.initializeCommunicationWithChild(a,b.Utils.Function.bind(this.onPostMessageReceived,this))},onPostMessageReceived:function(){this.on("click","a.bit-rsvp",this.rsvp_link_clicked_callback),this.on("click","a.bit-event-data",this.rsvp_link_clicked_callback),this.on("click","a.bit-buy-tix",this.buy_tickets_clicked_callback)},buy_tickets_clicked_callback:function(a){if(this.email_signup){var b=i.closest(a.target,"a"),c=i.closest(b,"tr").getAttribute("data-bit-event-id"),d=this.dialog.findIframeForWidget(this.timestamp);this.dialog.clicked_link=b,this.dialog.triggerEmailSignup({widget:this,iframe:d,event_id:c})}},rsvp_link_clicked_callback:function(a){b.Utils.Event.prevent_default(a);var c=i.closest(a.target,"a"),d=i.closest(c,"tr").getAttribute("data-bit-event-id"),e=this.dialog.findIframeForWidget(this.timestamp);this.dialog.hideIframes(),this.dialog.showLoader(),this.dialog.clicked_link=c,this.dialog.showIframeAndEvent({widget:this,iframe:e,event_id:d,action:"show_event"})},formatted_date:function(a){var b={"01":"Jan","02":"Feb","03":"Mar","04":"Apr","05":"May","06":"Jun","07":"Jul","08":"Aug","09":"Sep",10:"Oct",11:"Nov",12:"Dec"},c=a.datetime.split("T")[0].split("-");return b[c[1]]+" "+c[2]},toggle_events_table:function(a){var b=a.target.getAttribute("data-events-type"),c=i.search("table",this.root_element());d(c,function(a){a.style.display=a.getAttribute("data-events-type")===b?"":"none"})},show_all_events:function(a){var b=i.search("tbody",this.root_element())[0];skipped_tr_classnames=/bit-(local|dashed-border|event-description|bottom|header|event-details)/,d(b.childNodes,function(a){a.className&&!a.className.match(skipped_tr_classnames)&&(a.className="")}),i.css(i.closest(a.target,"tr"),{display:"none"})}},!0),e(b.Widget,{staticCSS:[".bit-widget-container { font-family:arial,helvetica,sans-serif; font-size:13px;}",".bit-events, .bit-events-narrow {overflow: hidden;display: table;}",".bit-events th, .bit-events td {width: auto;text-align: left; padding: 4px;vertical-align:middle;}",".bit-events td {height: 36px; background:none;}",".bit-events-narrow td {width:auto; height:57px; background:none;padding:4px;vertical-align:middle;}","#bit-events td.bit-tickets, #bit-events th.bit-tickets {width:55px; padding-right: 8px;}","#bit-events td.bit-artist-event-link { text-align: right; }","#bit-events td.bit-artist-event-link a { float: right; }","#bit-events td.bit-actions a, #bit-events td.bit-rsvp a { float: right; }","#bit-events td.bit-rsvp { width: 42px; padding-right: 8px; }","#bit-events td.bit-comment { width: 21px; padding-left: 8px; padding-right: 8px; }",'#bit-events td .bit-uiButton { display:inline-block; padding: 1px 6px; height: 16px; line-height: 16px !important; cursor: pointer; font-family: "lucida grande",tahoma,verdana,arial,sans-serif}','#bit-events td .bit-uiButton { background:#eee url("',b.assetHost,'/images/facebook/silver-blue-bg.png") repeat 0 0; border:1px solid #999; border-bottom-color:#888; box-shadow:0 1px 0 rgba(0, 0, 0, .1); -moz-box-shadow:0 1px 0 rgba(0, 0, 0, .1); font-size:11px; font-weight:bold; text-align:center; text-decoration:none; vertical-align:top; white-space:nowrap }',"#bit-events td .bit-uiButton:active{background:#ddd;border-bottom-color:#999;box-shadow:0 1px 0 rgba(0, 0, 0, .05);-moz-box-shadow:0 1px 0 rgba(0, 0, 0, .05)}",'#bit-events td .bit-uiButtonSpecial{background-image:url("',b.assetHost,'/images/facebook/silver-blue-bg.png"); background-repeat:no-repeat;background-position:0px -96px;background-color:#69a74e;border-color:#3b6e22 #3b6e22 #2c5115;}',"#bit-events td .bit-uiButtonSpecial:active{background:#609946;border-bottom-color:#3b6e22;}","#bit-events td .bit-uiButton a, .bit-uiButton a:hover { text-decoration: none; display: inline-block; }","#bit-events td .bit-uiButtonSpecial a { color: #FFFFFF; }","#bit-events td .bit-uiButtonDefault a { color: #333333; }","#bit-events td.bit-comment a.bit-comment { background: transparent url('",b.assetHost,"/images/facebook/comments_icon.gif') 0px 0px no-repeat; width: 15px; height: 16px; display: inline-block; margin-top: 2px; float: right; }","#bit-events td.bit-comment a:hover, #bit-events td.bit-comment a.bit-comment-open { background-position: 0px -16px; }","#bit-events td.bit-location {font-weight:bold;}","#bit-events td.bit-description, #bit-events th.bit-description {font-size: 85%; left: 8px 4px; }","#bit-events td.bit-description-links, #bit-events th.bit-description-links {padding-left: 8px; width: 6px;}","#bit-events .bit-hidden {display:none;}","#bit-events .bit-bottom td {padding-left:8px;height:36px;}","#bit-events .bit-bottom td.concerts-by-bandsintown {text-align:right;}","#bit-events .bit-bottom a { vertical-align: middle; border: none; display: inline-block; }","#bit-events table a { text-align: left; float: left; width:auto; }","#bit-events table a:hover { -webkit-transition: none; -moz-transition: none; -o-transition: none; transition: none; }","#bit-events td.bit-description a { float: none; }","#bit-events a.bit-event-description-link { text-decoration: none; margin: 0; padding: 0; display: inline-block; height: 9px; width: 9px; line-height: 9px; font-size: 9px; text-align: center; vertical-align: middle; border: none;}",".bit-events tr.bit-dashed-border td.bit-description-links, .bit-events tr.bit-dashed-border td.bit-date, .bit-events-narrow tr.bit-dashed-border td { border-top: 1px solid transparent;}","#bit-events td.bit-concert a { float: none; }","td.bit-date { width: 45px; }","tr.bit-header th, tr.bit-header-narrow { line-height: 26px; }","#bit-events tr.bit-header a, #bit-events tr.bit-header-narrow a { float: none; font-weight: normal; }","#bit-events tr.bit-header-narrow th { text-align: left; padding: 4px;}","#bit-events .bit-events-narrow tr.no-dates td a { display: block; }","#bit-events .bit-events td.no-dates td { padding: 20px 0px; }","#bit-events .bit-header-links { margin-right: 15px; }","#bit-events .bit-share-text { float:right; }","#bit-events .bit-share-links { float: right; }","#bit-events .bit-share-links a { display: inline-block; width: 26px; height: 26px; vertical-align: middle; }","#bit-events .bit-fb-share { background: transparent url('",b.assetHost,"/images/facebook/icons/fb_share.gif') top left no-repeat; margin-left: 4px; display: inline-block; width: 26px; height:26px; vertical-align: middle;}","#bit-events .bit-twitter-share { background: transparent url('",b.assetHost,"/images/facebook/icons/twitter_share.gif') top left no-repeat; display: inline-block; width: 26px; height:26px; vertical-align: middle;}","#bit-events .bit-events-narrow tr.no-dates td { padding-bottom: 25px; padding-top: 20px; }","#bit-events tr.no-dates td { padding-top: 10px; padding-bottom: 10px; }","#bit-events tr.no-dates td a { float: none; margin-top: 15px; }","#bit-events td.bit-concert a.bit-buy-tix { padding-right: 8px; }",".bit-header-overflow-fix { height: 26px; overflow: hidden; }","#bit-events iframe { border: none; }","#bit-events .comments-title, #bit-events .description-title { color: #323232; font-size: 11px; font-weight: bold; margin: 0px 0px 4px 0px;}","#bit-events .bit-event-details { color: #000000; }","#bit-events .bit-details-title { background-color: #ffffff; font-weight: bold; padding: 4px 8px 0px 20px; color: #0e0e0e; font-size: 11px; }","#bit-events .bit-details-title a { float: right; color: #8296cc; text-decoration: none; }","#bit-events .bit-details-title a:hover { color: #ffffff; text-decoration: none; }","#bit-events .bit-details-text { background-color: #ffffff; margin-bottom: 1px; padding: 5px 8px 5px 20px; color: #1A1A1A; }","#bit-events .bit-details-comments { background: transparent; padding: 0px; margin: 0px; }","#bit-events .bit-details-text a { color: #3857a0; float: none; }","#bit-events a.bit-fb-event-link { font-weight: bold; display: block; text-decoration: none; margin: 4px 0px; }","#bit-events tr td.bit-details { padding: 0px; }","#bit-events .venue, #bit-events .location, #bit-events .lineup { display: block; clear: left; font-size: smaller; line-height: 100%; }","#bit-events .location { font-weight: bold }","#bit-events a.bit-track-artist-header {text-align: center; padding: 10px 0px; font-size: 13px; line-height: 1.5; display: block; text-decoration: none; }","#bit-events a.bit-track-artist-header:hover {text-decoration: none;}","#bit-events a.bit-track-artist-header .bit-invert { display: inline-block; padding: 2px 20px; margin-bottom: 2px; }","#bit-events tr[data-bit-event-id] td { cursor: pointer; }"].join(""),VERSION:a}),b.Utils.Document.contentLoaded(this,b.Utils.Widget.renderAll);var j=document.getElementsByTagName("script"),k=j[j.length-1];b.setup(k)}).call(this);